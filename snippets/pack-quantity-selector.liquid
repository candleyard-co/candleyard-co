{%- doc -%}
  This snippet is used to render the quantity selector for a product.
  It is used in the product page and the cart page.
  @param {object} current_product - the main product
  @param {object} product - the product to render the quantity selector for
  @param {object} [variant] - the specific variant to use (for cart items), if not provided uses selected_or_first_available_variant
  @param {number} [in_cart_quantity] - the quantity in the cart to set the input value
  @param {number} [line_index] - the index of the forloop representing the line on which the quantity selector is rendered
  @param {string} [class] - custom class for the quantity selector, optional
  @param {boolean} [can_update_quantity] - whether the quantity can be updated, defaults to true
{%- enddoc -%}

{% liquid
  if variant
    assign variant = variant
  else
    assign variant = product.selected_or_first_available_variant
  endif

  assign pack_limit = current_product.selected_or_first_available_variant.metafields.custom.pack_limit | plus: 0
%}

<pack-selector-component
  class="quantity-selector{% if class %} {{ class }}{% endif %}"
  data-variant-id="{{ variant.id }}"
  {% if line_index == null %}
    {{- block.shopify_attributes -}}
  {% endif %}
  ref="quantitySelectors[]"
>
  <button
    class="button quantity-minus button-unstyled"
    type="button"
    name="minus"
    on:click="/decreaseQuantity"
    ref="minusButton"
    {% if can_update_quantity == false %}
      disabled
    {% endif %}
  >
    <span class="visually-hidden">{{ 'accessibility.decrease_quantity' | t }}</span
    ><span class="svg-wrapper icon-plus">
      {{- 'icon-minus.svg' | inline_asset_content -}}
    </span>
  </button>
  <input
    type="number"
    name="pack_item_quantity"
    value="0"
    min="0"
    on:blur="/setQuantity"
    on:focus="/selectInputValue"
    ref="quantityInput"
    aria-label="{{ 'accessibility.quantity' | t }}"
    readonly
    onkeydown="return false;"
    {% if variant.inventory_management == 'shopify' and variant.inventory_quantity %}
      data-variant-qty="{{ variant.inventory_quantity }}"
    {% endif %}
    {% if pack_limit %}
      max="{{ pack_limit }}"
    {% endif %}
    step="1"
    {% if can_update_quantity == false or variant.available == false %}
      disabled
    {% endif %}
  >
  <button
    class="button quantity-plus button-unstyled"
    type="button"
    name="plus"
    on:click="/increaseQuantity"
    ref="plusButton"
    {% if can_update_quantity == false %}
      disabled
    {% endif %}
  >
    <span class="visually-hidden">{{ 'accessibility.increase_quantity' | t }}</span
    ><span class="svg-wrapper icon-plus">
      {{- 'icon-plus.svg' | inline_asset_content -}}
    </span>
  </button>
</pack-selector-component>
